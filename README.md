# TrayPrinterApp

## ????
TrayPrinterApp ??? .NET 8 ??? Windows ???????????????????PDF??????????????PDF????????????????PDF????????????????????

## ?? ????
- **?? ??????**: ?????????????????????
- **?? ??????**: ???Word?????????PDF???????  
- **??? ??PDF??**: ??PdfiumViewer????PDF????
- **?? ?????**: ?????????????????????
- **?? ????**: ????????????????????
- **??? ????**: ??????????????????

## ??? ????

### ????
```
TrayApp/
??? ?? Core/                    # ???????
?   ??? ILogger                 # ????
?   ??? IConfigurationService   # ??????
?   ??? AppCore                 # ?????????
??? ??? Printing/               # ????????
?   ??? UnifiedPrintManager     # ???????
?   ??? ConverterFactory        # ???????
?   ??? PdfiumPrintEngine       # ??PDF????
?   ??? PdfConverter           # PDF???
?   ??? ImageToPdfConverter    # ???PDF???
?   ??? WordToPdfConverter     # Word?PDF???
??? ?? FolderMonitor/          # ?????
?   ??? FileSystemWatcherMonitor # ???????
??? ??? FileOperations/         # ????
?   ??? TimestampFileOperator   # ????????
??? ?? Configuration/          # ????
?   ??? JsonConfigurationService # JSON????
?   ??? UserDataPath           # ????????
??? ?? TaskHistory/            # ????
?   ??? TaskHistoryManager     # ???????
?   ??? UserDataTaskHistory    # ????????
??? ??? UI/                    # ????
    ??? TrayIconManager        # ???????
```

### ????
- **?? ??????**: ????????????
- **?? ????**: ????????????????
- **?? ????**: JSON?????????????
- **?? ????**: 104+?????85%+?????
- **?? ????**: ????????????????

## ?? ????
1. ????
   ```bash
   git clone https://github.com/quying2024/TrayPrinterApp.git
   ```
2. ?? Visual Studio 2022 ?? `TrayApp.sln`
3. ????? .NET 8 SDK
4. ?? `TrayApp` ??????????

## ?? ????
- **????**: Windows 10/11 (64?)
- **???**: .NET 8 Runtime  
- **??**: ?? 512MB RAM
- **??**: 100MB ??????
- **????**: 
  - Microsoft Office (Word????)
  - PdfiumViewer (PDF??)
  - iTextSharp (PDF??)

## ?? ????

??????`config/appsettings.json`

```json
{
  "Monitoring": {
    "WatchPath": "C:\\WeChatPrintFiles",
    "BatchTimeoutSeconds": 3,
    "FileTypes": [".pdf", ".docx", ".doc", ".jpg", ".png", ".bmp"]
  },
  "PrintSettings": {
    "DefaultCopies": 1,
    "DefaultOrientation": "Portrait",
    "AutoSelectPrinter": false
  },
  "PrinterManagement": {
    "HiddenPrinters": ["Microsoft Print to PDF", "Fax"],
    "DisplayOrder": "UsageFrequency"
  },
  "TaskHistorySettings": {
    "MaxRecords": 50,
    "EnableHistory": true
  }
}
```

## ?? ????
- **?? [???????](docs/???????.md)** - ??????????
- **?? [????](docs/VS2022????.md)** - ???????????  
- **? [????](docs/????????.md)** - ?????????
- **??? [????](????????.md)** - ?????????
- **?? [????](??????????.md)** - ??????????
- **?? [MSI??](docs/??MSI??.md)** - ???????

## ?? ????

### ????
```bash
# ??????
dotnet test tests/TrayApp.Tests.csproj

# ???????
powershell -File run-safe-tests.ps1
```

### ?????
```bash
# ???????
dotnet test tests/TrayApp.Tests.csproj --collect:"XPlat Code Coverage"
```

???????
- ? **104+ ????** ????
- ? **85%+ ?????** ????
- ? **????** ???????
- ? **????** ??????

## ?? ????

### ????
- Visual Studio 2022 (17.8+)
- .NET 8 SDK
- Git for Windows

### ????
- ?? Microsoft C# ????
- ??????????80%
- ???????????

### ????
1. Fork ??
2. ?????? (`git checkout -b feature/AmazingFeature`)
3. ???? (`git commit -m 'Add some AmazingFeature'`)
4. ????? (`git push origin feature/AmazingFeature`)
5. ?? Pull Request

## ?? ???
????? MIT ?????? [LICENSE](LICENSE) ???

## ?? ????

### v2.0.0 (????)
- ?? **??????**: ??PDF????
- ?? **??????**: Word??????PDF
- ??? **??????**: ??PdfiumViewer????PDF??
- ?? **????**: 104+???????????
- ?? **????**: ??PrintSettings?TaskHistorySettings
- ?? **?????**: ?????????????

### v1.x.x (????)
- ??????
- ????????
- ???????

---

**?? ????**: ?????????????????????????????????????????????