# TrayPrinterApp - ç»Ÿä¸€PDFæ‰“å°æ¶æ„è®¾è®¡

## ğŸ¯ æ¶æ„æ¦‚è§ˆ

TrayPrinterApp é‡‡ç”¨ç°ä»£åŒ–çš„ç»Ÿä¸€PDFæ‰“å°æ¶æ„ï¼Œå°†æ‰€æœ‰æ–‡æ¡£ç±»å‹è½¬æ¢ä¸ºPDFæ ¼å¼åè¿›è¡Œç»Ÿä¸€å¤„ç†ï¼Œå®ç°é«˜æ€§èƒ½ã€é«˜ç¨³å®šæ€§çš„è‡ªåŠ¨åŒ–æ‰“å°è§£å†³æ–¹æ¡ˆã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ–¥ï¸  è¡¨ç°å±‚ (Presentation Layer)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   æ‰˜ç›˜å›¾æ ‡UI    â”‚  â”‚ æ‰“å°æœºé€‰æ‹©å¯¹è¯æ¡† â”‚  â”‚  å†å²æŸ¥çœ‹   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”§ åº”ç”¨åè°ƒå±‚ (Application Coordination Layer)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚             AppCore (åº”ç”¨ç¨‹åºæ ¸å¿ƒ)                      â”‚  â”‚
â”‚  â”‚  - ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†   - äº‹ä»¶åè°ƒ   - å¼‚å¸¸å¤„ç†           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”„ ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   æ–‡ä»¶å¤¹ç›‘è§†     â”‚  â”‚  ç»Ÿä¸€æ‰“å°ç®¡ç†    â”‚  â”‚  ä»»åŠ¡å†å²   â”‚  â”‚
â”‚  â”‚ FileSystemWatcherâ”‚  â”‚UnifiedPrintManagerâ”‚ â”‚TaskHistory  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   æ–‡ä»¶è½¬æ¢       â”‚  â”‚   PDFæ‰“å°å¼•æ“   â”‚  â”‚  æ–‡ä»¶æ“ä½œ   â”‚  â”‚
â”‚  â”‚ ConverterFactory â”‚  â”‚PdfiumPrintEngineâ”‚  â”‚FileOperator â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¾ æ•°æ®è®¿é—®å±‚ (Data Access Layer)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   é…ç½®ç®¡ç†       â”‚  â”‚   æ—¥å¿—ç³»ç»Ÿ      â”‚  â”‚  ç”¨æˆ·æ•°æ®   â”‚  â”‚
â”‚  â”‚ConfigurationSvc  â”‚  â”‚   FileLogger    â”‚  â”‚ UserDataPathâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

### ğŸ¯ æ ¸å¿ƒè®¾è®¡åŸåˆ™
```
TrayPrinterApp/
â”œâ”€â”€ src/                        # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ TrayApp.Core.cs         # ğŸ”§ æ ¸å¿ƒæ¥å£å’ŒåŸºç¡€æœåŠ¡
â”‚   â”œâ”€â”€ TrayApp.Printing.Core.cs       # ğŸ–¨ï¸ æ‰“å°ç³»ç»Ÿæ ¸å¿ƒæ¥å£
â”‚   â”œâ”€â”€ TrayApp.Printing.cs             # ğŸ–¨ï¸ ç»Ÿä¸€æ‰“å°ç®¡ç†å™¨
â”‚   â”œâ”€â”€ TrayApp.Printing.Engines.cs    # ğŸ–¨ï¸ ä¸“ç”¨PDFæ‰“å°å¼•æ“
â”‚   â”œâ”€â”€ TrayApp.Printing.Converters.cs # ğŸ”„ æ–‡ä»¶è½¬æ¢å™¨å·¥å‚
â”‚   â”œâ”€â”€ TrayApp.Printing.ImageConverter.cs  # ğŸ–¼ï¸ å›¾ç‰‡è½¬PDFè½¬æ¢å™¨
â”‚   â”œâ”€â”€ TrayApp.Printing.WordConverter.cs   # ğŸ“„ Wordè½¬PDFè½¬æ¢å™¨
â”‚   â”œâ”€â”€ TrayApp.FolderMonitor.cs        # ğŸ“ æ–‡ä»¶å¤¹ç›‘è§†æ¨¡å—
â”‚   â”œâ”€â”€ TrayApp.FileOperations.cs      # ğŸ—‚ï¸ æ–‡ä»¶æ“ä½œæ¨¡å—
â”‚   â”œâ”€â”€ TrayApp.Configuration.cs       # âš™ï¸ é…ç½®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ TrayApp.TaskHistory.cs         # ğŸ“Š ä»»åŠ¡å†å²æ¨¡å—
â”‚   â”œâ”€â”€ TrayApp.UI.cs                  # ğŸ–¥ï¸ ç”¨æˆ·ç•Œé¢æ¨¡å—
â”‚   â””â”€â”€ TrayApp.cs                     # ğŸš€ ä¸»åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ appsettings.json       # ä¸»é…ç½®æ–‡ä»¶
â””â”€â”€ tests/                      # æµ‹è¯•é¡¹ç›®ç›®å½•
    â”œâ”€â”€ Core/                  # æ ¸å¿ƒç»„ä»¶æµ‹è¯•
    â”œâ”€â”€ Printing/              # æ‰“å°ç³»ç»Ÿæµ‹è¯•
    â”œâ”€â”€ Configuration/         # é…ç½®ç®¡ç†æµ‹è¯•
    â”œâ”€â”€ FileOperations/        # æ–‡ä»¶æ“ä½œæµ‹è¯•
    â”œâ”€â”€ TaskHistory/           # ä»»åŠ¡å†å²æµ‹è¯•
    â”œâ”€â”€ Integration/           # é›†æˆæµ‹è¯•
    â””â”€â”€ Quick/                 # å¿«é€ŸéªŒè¯æµ‹è¯•
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. TrayApp.Core - æ ¸å¿ƒåŸºç¡€è®¾æ–½

**èŒè´£**: å®šä¹‰ç³»ç»Ÿæ ¸å¿ƒæ¥å£å’ŒåŸºç¡€æœåŠ¡ï¼Œç¡®ä¿å„æ¨¡å—è§£è€¦

**å…³é”®æ¥å£**:
```csharp
// æ ¸å¿ƒåŸºç¡€æ¥å£
public interface ILogger                    # ç»Ÿä¸€æ—¥å¿—æ¥å£
public interface IConfigurationService      # é…ç½®æœåŠ¡æ¥å£  
public interface IDisposable               # èµ„æºé‡Šæ”¾æ¥å£

// åº”ç”¨ç¨‹åºæ ¸å¿ƒ
public class AppCore                       # åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸç®¡ç†
public class FileLogger                    # æ–‡ä»¶æ—¥å¿—å®ç°
```

**è®¾è®¡ç‰¹ç‚¹**:
- æ¥å£ä¼˜å…ˆè®¾è®¡ï¼Œæ”¯æŒä¾èµ–æ³¨å…¥
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•
- èµ„æºç”Ÿå‘½å‘¨æœŸè‡ªåŠ¨ç®¡ç†

### 2. TrayApp.Printing - ç»Ÿä¸€æ‰“å°ç®¡ç†ç³»ç»Ÿ ğŸ¯

**æ¶æ„äº®ç‚¹**: å°†æ‰€æœ‰æ–‡æ¡£ç±»å‹è½¬æ¢ä¸ºPDFåç»Ÿä¸€å¤„ç†ï¼Œé¿å…å¤šç§æ‰“å°ç¨‹åºçš„å¤æ‚æ€§

#### 2.1 æ ¸å¿ƒç»„ä»¶ç»“æ„
```csharp
// æ‰“å°ç³»ç»Ÿæ ¸å¿ƒæ¥å£ (TrayApp.Printing.Core.cs)
public interface IPrintManager            # æ‰“å°ç®¡ç†å™¨æ¥å£
public interface IFileConverter           # æ–‡ä»¶è½¬æ¢å™¨æ¥å£  
public interface IPrintEngine             # æ‰“å°å¼•æ“æ¥å£

// ç»Ÿä¸€æ‰“å°ç®¡ç†å™¨ (TrayApp.Printing.cs)
public class UnifiedPrintManager : IPrintManager
{
    - ConverterFactory _converterFactory   # è½¬æ¢å™¨å·¥å‚
    - PdfiumPrintEngine _printEngine      # PDFæ‰“å°å¼•æ“
    - ç»Ÿä¸€å¤„ç†æ‰€æœ‰æ–‡ä»¶ç±»å‹è½¬æ¢å’Œæ‰“å°
}

// æ–‡ä»¶è½¬æ¢å™¨ç³»ç»Ÿ (TrayApp.Printing.Converters.cs)
public class ConverterFactory             # è½¬æ¢å™¨å·¥å‚
public class PdfConverter                # PDFå¤„ç†å™¨(ç›´æ¥å¤„ç†)
```

#### 2.2 ä¸“ç”¨è½¬æ¢å™¨
```csharp
// å›¾ç‰‡è½¬PDFè½¬æ¢å™¨ (TrayApp.Printing.ImageConverter.cs)
public class ImageToPdfConverter : IFileConverter
{
    - æ”¯æŒ: JPG, PNG, BMP, TIFF æ ¼å¼
    - ä½¿ç”¨iTextSharpè¿›è¡Œé«˜è´¨é‡è½¬æ¢
    - è‡ªåŠ¨é¡µé¢å¸ƒå±€å’Œå°ºå¯¸è°ƒæ•´
}

// Wordè½¬PDFè½¬æ¢å™¨ (TrayApp.Printing.WordConverter.cs)  
public class WordToPdfConverter : IFileConverter
{
    - æ”¯æŒ: DOCX, DOC æ ¼å¼
    - è°ƒç”¨Microsoft Office API
    - ä¿æŒåŸå§‹æ ¼å¼å’Œå¸ƒå±€
}
```

#### 2.3 ä¸“ç”¨PDFæ‰“å°å¼•æ“
```csharp
// PDFæ‰“å°å¼•æ“ (TrayApp.Printing.Engines.cs)
public class PdfiumPrintEngine : IPrintEngine
{
    - åŸºäºPdfiumVieweré«˜æ€§èƒ½PDFæ¸²æŸ“
    - ç›´æ¥ç³»ç»Ÿæ‰“å°APIè°ƒç”¨
    - æ”¯æŒé¡µé¢èŒƒå›´å’Œæ‰“å°è®¾ç½®
    - æ— éœ€Adobe Acrobatç­‰å¤–éƒ¨ç¨‹åº
}
```

### 3. TrayApp.FolderMonitor - æ™ºèƒ½æ–‡ä»¶ç›‘è§†

**æ ¸å¿ƒç‰¹æ€§**:
```csharp
public class FileSystemWatcherMonitor : IFolderMonitor
{
    - å®æ—¶æ–‡ä»¶ç³»ç»Ÿç›‘æ§
    - 3ç§’æ™ºèƒ½æ‰¹é‡æ”¶é›†
    - æ–‡ä»¶å®Œæ•´æ€§éªŒè¯
    - æ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹è¿‡æ»¤
}

// æ‰¹é‡å¤„ç†æœºåˆ¶
private void OnBatchTimerElapsed(object sender, ElapsedEventArgs e)
{
    // è§¦å‘ FilesBatchReady äº‹ä»¶
    // æºå¸¦æ‰¹é‡æ–‡ä»¶åˆ—è¡¨è¿›è¡Œåç»­å¤„ç†
}
```

### 4. TrayApp.Configuration - é…ç½®ç®¡ç†å¢å¼º

**æ–°å¢é…ç½®ç»“æ„**:
```csharp
public class AppSettings
{
    public MonitoringSettings Monitoring           # æ–‡ä»¶ç›‘è§†é…ç½®
    public PrintSettings PrintSettings             # ğŸ†• æ‰“å°ç³»ç»Ÿé…ç½®  
    public PrinterManagementSettings PrinterMgmt   # æ‰“å°æœºç®¡ç†é…ç½®
    public TaskHistorySettings TaskHistory         # ğŸ†• ä»»åŠ¡å†å²é…ç½®
}

// ğŸ†• æ‰“å°ç³»ç»Ÿé…ç½®
public class PrintSettings
{
    public int DefaultCopies                       # é»˜è®¤æ‰“å°ä»½æ•°
    public string DefaultOrientation               # é»˜è®¤é¡µé¢æ–¹å‘
    public bool AutoSelectPrinter                  # è‡ªåŠ¨é€‰æ‹©æ‰“å°æœº
    public Dictionary<string, object> AdvancedSettings  # é«˜çº§è®¾ç½®
}

// ğŸ†• ä»»åŠ¡å†å²é…ç½®  
public class TaskHistorySettings
{
    public int MaxRecords                          # æœ€å¤§å†å²è®°å½•æ•°
    public bool EnableHistory                      # å¯ç”¨å†å²è®°å½•
    public string StoragePath                      # å­˜å‚¨è·¯å¾„
}
```

### 5. TrayApp.TaskHistory - ä»»åŠ¡å†å²å¢å¼º

**æ–°åŠŸèƒ½ç‰¹æ€§**:
```csharp
public class TaskHistoryManager : ITaskHistoryManager
{
    - å¢å¼ºçš„ä»»åŠ¡è®°å½•æ•°æ®æ¨¡å‹
    - ç”¨æˆ·æ•°æ®ç›®å½•è‡ªåŠ¨ç®¡ç†  
    - å¾ªç¯ç¼“å†²åŒºå­˜å‚¨æœºåˆ¶
    - æ”¯æŒå¯¼å‡ºå’Œæ•°æ®åˆ†æ
}

// ğŸ†• ç”¨æˆ·æ•°æ®ä»»åŠ¡å†å²
public class UserDataTaskHistory : ITaskHistoryManager
{
    - ä½¿ç”¨ç”¨æˆ·æ•°æ®ç›®å½•å­˜å‚¨
    - è·¨ç”¨æˆ·ä¼šè¯æ•°æ®æŒä¹…åŒ–
    - è‡ªåŠ¨å¤‡ä»½å’Œæ¢å¤æœºåˆ¶
}
```

### 6. TrayApp.UI - ç”¨æˆ·ç•Œé¢æ¨¡å—

**ç•Œé¢ç»„ä»¶**:
```csharp
public class TrayIconManager : IDisposable
{
    - ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡ç®¡ç†
    - æ‰“å°æœºé€‰æ‹©å¯¹è¯æ¡†
    - ä»»åŠ¡å†å²å±•ç¤º
    - é…ç½®æ›´æ–°äº‹ä»¶å¤„ç†
    - å³é”®ä¸Šä¸‹æ–‡èœå•
}
```

## ğŸ”„ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### ç»Ÿä¸€PDFæ‰“å°å·¥ä½œæµ
```mermaid
graph TB
    A[æ–‡ä»¶æ¥æ”¶] --> B[æ–‡ä»¶ç±»å‹æ£€æµ‹]
    B --> C{éœ€è¦è½¬æ¢?}
    C -->|æ˜¯| D[è°ƒç”¨å¯¹åº”è½¬æ¢å™¨]
    C -->|å¦| E[ç›´æ¥PDFå¤„ç†]
    D --> F[è½¬æ¢ä¸ºPDF]
    F --> G[PDFæ‰“å°å¼•æ“]
    E --> G
    G --> H[æ‰“å°æ‰§è¡Œ]
    H --> I[æ–‡ä»¶å½’æ¡£]
    I --> J[å†å²è®°å½•]
```

### å…³é”®æŠ€æœ¯åˆ›æ–°

#### 1. ç»Ÿä¸€è½¬æ¢ç®¡é“
```csharp
// è½¬æ¢å·¥å‚æ¨¡å¼å®ç°
public IFileConverter GetConverter(string fileExtension)
{
    return fileExtension.ToLower() switch
    {
        ".pdf" => new PdfConverter(),
        ".docx" or ".doc" => new WordToPdfConverter(),  
        ".jpg" or ".png" or ".bmp" => new ImageToPdfConverter(),
        _ => throw new NotSupportedException($"Unsupported file type: {fileExtension}")
    };
}
```

#### 2. é«˜æ€§èƒ½PDFæ‰“å°
```csharp
// åŸºäºPdfiumViewerçš„ç›´æ¥æ‰“å°å®ç°
public async Task<bool> PrintPdfAsync(string pdfPath, string printerName)
{
    using var document = PdfDocument.Load(pdfPath);
    using var printDocument = document.CreatePrintDocument();
    
    printDocument.PrinterSettings.PrinterName = printerName;
    printDocument.Print();  // ç›´æ¥ç³»ç»ŸAPIè°ƒç”¨
    
    return true;
}
```

#### 3. æ™ºèƒ½æ‰¹é‡å¤„ç†
```csharp
// æ»‘åŠ¨æ—¶é—´çª—å£ç®—æ³•
private void AddFileToBatch(string filePath)
{
    _pendingFiles.Add(filePath);
    _batchTimer?.Stop();
    _batchTimer?.Start();  // é‡ç½®3ç§’å€’è®¡æ—¶
}
```

## ğŸ§ª æµ‹è¯•æ¶æ„

### æµ‹è¯•è¦†ç›–ä½“ç³»
```
Tests/
â”œâ”€â”€ ğŸ”§ Core/                   # æ ¸å¿ƒç»„ä»¶æµ‹è¯• (20+ æµ‹è¯•)
â”‚   â”œâ”€â”€ AppCoreTests           # åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸ
â”‚   â”œâ”€â”€ FileLoggerTests        # æ—¥å¿—ç³»ç»Ÿæµ‹è¯•
â”‚   â””â”€â”€ ConfigHotUpdateTests   # é…ç½®çƒ­æ›´æ–°æµ‹è¯•
â”œâ”€â”€ ğŸ–¨ï¸ Printing/              # æ‰“å°ç³»ç»Ÿæµ‹è¯• (35+ æµ‹è¯•)  
â”‚   â”œâ”€â”€ UnifiedPrintManagerTests    # ç»Ÿä¸€æ‰“å°ç®¡ç†å™¨
â”‚   â”œâ”€â”€ FileConvertersTests         # æ–‡ä»¶è½¬æ¢å™¨æµ‹è¯•
â”‚   â””â”€â”€ PdfPrintEngineTests         # PDFæ‰“å°å¼•æ“æµ‹è¯•
â”œâ”€â”€ âš™ï¸ Configuration/          # é…ç½®ç®¡ç†æµ‹è¯• (15+ æµ‹è¯•)
â”œâ”€â”€ ğŸ“ FolderMonitor/          # æ–‡ä»¶ç›‘è§†æµ‹è¯• (20+ æµ‹è¯•)
â”œâ”€â”€ ğŸ—‚ï¸ FileOperations/         # æ–‡ä»¶æ“ä½œæµ‹è¯• (15+ æµ‹è¯•)  
â”œâ”€â”€ ğŸ“Š TaskHistory/            # ä»»åŠ¡å†å²æµ‹è¯• (10+ æµ‹è¯•)
â”œâ”€â”€ ğŸ–¥ï¸ UI/                    # ç•Œé¢ç»„ä»¶æµ‹è¯• (8+ æµ‹è¯•)
â””â”€â”€ ğŸ”— Integration/           # é›†æˆæµ‹è¯• (10+ æµ‹è¯•)

æ€»è®¡: 104+ å•å…ƒæµ‹è¯•ï¼Œ85%+ ä»£ç è¦†ç›–ç‡
```

### æµ‹è¯•ç­–ç•¥
1. **å•å…ƒæµ‹è¯•**: æ¯ä¸ªç»„ä»¶ç‹¬ç«‹æµ‹è¯•ï¼ŒMockå¤–éƒ¨ä¾èµ–
2. **é›†æˆæµ‹è¯•**: éªŒè¯ç»„ä»¶åä½œå’Œç«¯åˆ°ç«¯åŠŸèƒ½  
3. **æ€§èƒ½æµ‹è¯•**: æ‰¹é‡å¤„ç†èƒ½åŠ›å’Œå†…å­˜ä½¿ç”¨ç›‘æ§
4. **å¼‚å¸¸æµ‹è¯•**: è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯æ¢å¤éªŒè¯

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å…³é”®æ€§èƒ½æŒ‡æ ‡
- **å¯åŠ¨æ—¶é—´**: < 3ç§’ (ä»åŒå‡»åˆ°æ‰˜ç›˜å›¾æ ‡æ˜¾ç¤º)
- **æ–‡ä»¶è½¬æ¢**: < 5ç§’/MB (Wordè½¬PDF)
- **æ‰“å°å“åº”**: < 2ç§’ (PDFå‘é€åˆ°æ‰“å°é˜Ÿåˆ—)
- **å†…å­˜å ç”¨**: < 100MB (ç©ºé—²çŠ¶æ€)
- **å¹¶å‘å¤„ç†**: æ”¯æŒ50+æ–‡ä»¶æ‰¹é‡å¤„ç†

### ä¼˜åŒ–æŠ€æœ¯
1. **å¼‚æ­¥å¤„ç†**: æ‰€æœ‰I/Oæ“ä½œä½¿ç”¨async/await
2. **èµ„æºæ± åŒ–**: PDFè½¬æ¢å™¨å¯¹è±¡é‡ç”¨
3. **å†…å­˜ç®¡ç†**: åŠæ—¶é‡Šæ”¾å¤§æ–‡ä»¶èµ„æº
4. **ç¼“å­˜æœºåˆ¶**: æ‰“å°æœºåˆ—è¡¨å’Œé…ç½®ç¼“å­˜

## ğŸš€ æ‰©å±•æ€§è®¾è®¡

### æ’ä»¶åŒ–æ¶æ„
- **è½¬æ¢å™¨æ’ä»¶**: æ”¯æŒæ–°å¢æ–‡ä»¶æ ¼å¼è½¬æ¢å™¨
- **æ‰“å°å¼•æ“æ’ä»¶**: æ”¯æŒä¸åŒæ‰“å°æŠ€æœ¯æ ˆ
- **å­˜å‚¨æ’ä»¶**: æ”¯æŒäº‘å­˜å‚¨å’Œæ•°æ®åº“åç«¯

### é…ç½®é©±åŠ¨
- **é›¶ä»£ç æ‰©å±•**: é€šè¿‡JSONé…ç½®æ·»åŠ æ–°æ–‡ä»¶ç±»å‹
- **åŠ¨æ€åŠ è½½**: è¿è¡Œæ—¶é…ç½®æ›´æ–°æ— éœ€é‡å¯
- **å¤šç¯å¢ƒæ”¯æŒ**: å¼€å‘/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒç‹¬ç«‹é…ç½®

## ğŸ”’ å®‰å…¨æ€§ä¿éšœ

### æ–‡ä»¶å®‰å…¨
- **è·¯å¾„éªŒè¯**: é˜²æ­¢ç›®å½•éå†æ”»å‡»
- **æ–‡ä»¶ç±»å‹æ ¡éªŒ**: åŸºäºæ–‡ä»¶å¤´çš„çœŸå®æ€§æ£€æŸ¥
- **èµ„æºéš”ç¦»**: è½¬æ¢å’Œæ‰“å°è¿›ç¨‹æ²™ç®±åŒ–

### ç³»ç»Ÿå®‰å…¨  
- **æƒé™æœ€å°åŒ–**: ä»…è¯·æ±‚å¿…è¦çš„æ–‡ä»¶ç³»ç»Ÿæƒé™
- **å¼‚å¸¸éš”ç¦»**: å•ä¸ªæ–‡ä»¶é”™è¯¯ä¸å½±å“æ•´ä½“ç³»ç»Ÿ
- **æ—¥å¿—è„±æ•**: æ•æ„Ÿè·¯å¾„ä¿¡æ¯è‡ªåŠ¨è„±æ•å¤„ç†

---

**ğŸ¯ æ¶æ„è®¾è®¡ç›®æ ‡**: é€šè¿‡ç»Ÿä¸€PDFæ‰“å°æ¶æ„ï¼Œå®ç°é«˜æ€§èƒ½ã€é«˜ç¨³å®šæ€§ã€é«˜å¯ç»´æŠ¤æ€§çš„è‡ªåŠ¨åŒ–æ‰“å°è§£å†³æ–¹æ¡ˆï¼Œä¸ºæ‰“å°åº—æ•°å­—åŒ–è½¬å‹æä¾›åšå®çš„æŠ€æœ¯åŸºç¡€ã€‚