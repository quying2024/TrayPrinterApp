# TrayPrinterApp PDF????????

## ????

???TrayPrinterApp??JPG???PDF???????????

```
[ERROR] ??PDF??: Unable to load DLL 'pdfium.dll' or one of its dependencies: ????????? (0x8007007E)
```

## ????

TrayPrinterApp??PdfiumViewer.Core???PDF??????????`pdfium.dll`?????.NET??????????????????????????????????DLL?

## ? ????

### ??1?????????

1. **??????**
   - ????`fix-pdf-printing.ps1`?`deploy-pdfium-native.ps1`????

2. **??????**
   ```powershell
   # ??PowerShell?????
   # ???TrayPrinterApp??
   cd "C:\Path\To\TrayPrinterApp"
   
   # ??????
   .\fix-pdf-printing.ps1 -AutoFix
   ```

3. **????????**
   - ??????????TrayPrinterApp
   - ????PDF???????????

### ??2?????

????????????????????

#### ??1???????
```powershell
dotnet clean src/TrayApp.csproj
dotnet restore src/TrayApp.csproj
dotnet build src/TrayApp.csproj --configuration Release
```

#### ??2????????

1. **??PdfiumViewer????**
   - ???https://github.com/bblanchon/pdfium-binaries/releases
   - ?????Windows x64?pdfium?

2. **??????????**
   ```powershell
   # ??????pdfium.dll
   Invoke-WebRequest -Uri "https://github.com/bblanchon/pdfium-binaries/releases/download/chromium%2F6666/pdfium-win-x64.tgz" -OutFile "pdfium-win-x64.tgz"
   
   # ?????tar?????
   tar -xf pdfium-win-x64.tgz
   
   # ??pdfium.dll???????
   copy bin\pdfium.dll "C:\Path\To\Your\TrayApp\Directory\"
   ```

#### ??3???????

???????????????
- `TrayApp.exe`
- `pdfium.dll` (?5MB)
- `pdfiumviewer.dll` (????)
- ????DLL??

### ??3???????

???????????????????

```powershell
.\deploy-production.ps1 -DeployPath "C:\Program Files\TrayPrinterApp"
```

## ?? ??????

### 1. ??????
????????????????
```
TrayApp.exe
pdfium.dll (???5MB)
TrayApp.dll
PdfiumViewer.dll
```

### 2. ??????
1. ??TrayPrinterApp
2. ???JPG???PDF????????
3. ?????????
4. ????????"Unable to load DLL"??

### 3. ????
???????????????
```
[INFO] PdfiumViewer???????
[INFO] ???????PDF: filename.jpg
[INFO] ???PDF??: filename.jpg, ??: 1920x1080
```

## ??? ????

### ??1?????????
**??**: `????????????????????`

**??**:
```powershell
# ????????PowerShell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### ??2?????
**??**: `????????????pdfium.dll`

**??**:
1. ??????
2. ???GitHub????
3. ????????????pdfium.dll

### ??3?????
**??**: `??????????`

**??**:
1. ????????PowerShell
2. ????????????
3. ?????????????

### ??4????????
**????**:
- ??Visual C++???
- ????.NET 8???
- ????????

**????**:
1. ?????Visual C++ Redistributable
2. ?????.NET 8 Runtime
3. ???????pdfium.dll??

## ?? ????

### ?????pdfium.dll?
- PdfiumViewer.Core?PDF???.NET???
- ???PDF?????Google?Pdfium???
- Pdfium??C++????????DLL??

### ?????
- ????x64???pdfium.dll????64?Windows?
- TrayPrinterApp???AnyCPU???64?????????64????

### ??????
1. ?????????????
2. ?CI/CD??????????
3. ???????????????

## ?? ????

### ????
- ?????????????
- ??????????????
- ??????????????

### ????
- ???????????
- ????????DLL??
- ??????????

---

## ?? ????

???????????????????

1. **??????**
   ```powershell
   .\fix-pdf-printing.ps1 -Verbose
   ```

2. **??????**
   ??????????????????

3. **??????**
   - Windows??
   - .NET?? (`dotnet --version`)
   - ????????
   - ?????????

---

*?????TrayPrinterApp v2.0???PdfiumViewer.Core + System.Drawing.Printing???*