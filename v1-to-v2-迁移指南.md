# TrayPrinterApp ???????v1.x ? v2.0 ??PDF???

## ?? ????

?????TrayPrinterApp???????????v1.x??????PDF?????v2.0?????????????????????

## ?? ????

### v1.x ???? ?
```
???? ? ?????? ? ????
   ?           ?              ?
PDF??    Adobe Acrobat    ???A
Word??   Microsoft Word   ???B  
????   ??????      ???C
```

**??**?
- ?????????????
- ?????????????
- ???????????????
- ??????????

### v2.0 ??PDF?? ?
```
???? ? ???? ? ??PDF??
   ?           ?           ?
PDF??    ????     PdfiumViewer
Word??   ???PDF    ??????
????   ???PDF    ?????
```

**??**?
- ?????????PDF??
- ????PDF?????????
- ???????????
- ???????????

## ?? ??????

### 1. ?????? ??

#### ????
- **UnifiedPrintManager**: ??????????ExternalPrintManager
- **ConverterFactory**: ????????????????
- **PdfiumPrintEngine**: ??PDF?????????????
- **WordToPdfConverter**: Word???PDF???
- **ImageToPdfConverter**: ???PDF???

#### ????
- ~~ExternalPrintManager~~: ?????????
- ~~FileTypeAssociation~~: ????????
- ~~????????~~: Adobe Acrobat?Word?????

### 2. ?????? ??

#### ?????
```json
{
  "PrintSettings": {                    // ?? ??????
    "DefaultCopies": 1,
    "DefaultOrientation": "Portrait",
    "AutoSelectPrinter": false
  },
  "TaskHistorySettings": {             // ?? ??????
    "MaxRecords": 50,
    "EnableHistory": true,
    "StoragePath": "task_history.json"
  }
}
```

#### ?????
```json
{
  // ? ???
  "FileTypeAssociations": {
    ".pdf": {
      "ExecutorPath": "C:\\Program Files\\Adobe\\...",
      "Arguments": "/t \"{FilePath}\" \"{PrinterName}\""
    }
  }
}
```

### 3. ??????

#### ???? ??
- **PdfiumViewer** (2.13.0+): PDF?????
- **iTextSharp** (5.5.13.3+): PDF????
- **Microsoft.Office.Interop.Word**: Word????????Office?

#### ????
- ~~Adobe Acrobat/Reader~~: ??????PDF??
- ~~???????~~: ????????

### 4. ???????

#### v2.0 ?? ??
- **.NET 8 Runtime**: ??.NET Framework 4.8
- **Windows 10 1909+**: ????????
- **Microsoft Office 2016+**: Word??????

#### v1.x ?? ?
- ~~.NET Framework 4.8~~
- ~~Windows 7+~~
- ~~Adobe Acrobat/Reader~~

## ?? ????

### ??1?????
1. **??.NET 8 Runtime**?
   ```bash
   # ??????
   dotnet --version
   
   # ???????.NET 8
   # https://dotnet.microsoft.com/download/dotnet/8.0
   ```

2. **??Office??**?
   - ??Microsoft Word?????
   - ??Word???PDF??

### ??2?????
1. **?????**?
   ```bash
   copy config\appsettings.json config\appsettings_v1_backup.json
   ```

2. **??????**?
   ```json
   {
     // ??????
     "Monitoring": { ... },
     "PrinterManagement": { ... },
     
     // ??????
     "PrintSettings": {
       "DefaultCopies": 1,
       "DefaultOrientation": "Portrait",
       "AutoSelectPrinter": false
     },
     "TaskHistorySettings": {
       "MaxRecords": 50,
       "EnableHistory": true
     }
   }
   ```

3. **??????**?
   - ??`FileTypeAssociations`???????
   - ??????????

### ??3?????
1. **??????**?
   - ?????????????
   - ?????????

2. **??????**?
   ```
   ???????
   ??? PDF?? ? ???? ?
   ??? Word?? ? ???PDF ? ?? ?
   ??? ???? ? ???PDF ? ?? ?
   ```

3. **??????**?
   - ??PDF????????
   - ????????????

## ?? ????

### ?????
1. **????Windows 7/8**???PDF????Windows 10+
2. **Adobe Acrobat????**???PDF????
3. **????????**?????????

### ????
1. **??????**??????PDF????
2. **??????**???????????
3. **??????**?Office???????

### ????
1. **Word????Office**????????Microsoft Office
2. **??????**????JPG?PNG?BMP?TIFF
3. **PDF????**???PdfiumViewer???PDF??

## ?? ????

### ??????

#### ??1???????
**??**???exe?????????????
**????**?
1. ??.NET 8 Runtime?????
2. ??Windows?????10 1909+?
3. ????????

#### ??2?Word????
**??**?Word???????PDF
**????**?
1. ??Microsoft Office?????????
2. ??????????????`WINWORD.exe`??
3. ????????????

#### ??3?PDF??????
**??**?PDF???????????
**????**?
1. ????????????
2. ???????????????
3. ???PDF??????

#### ??4???????
**??**??????????????
**????**?
1. ??JSON??????
2. ?????????????????
3. ??????????

## ?? ????

### ??????
```
??: 10?PDF??????
??? v1.x (Adobe Acrobat): 45?
??? v2.0 (??PDF??): 25? ?

??: 5?Word????  
??? v1.x (Word????): 60?
??? v2.0 (?PDF????): 40? ?
```

### ?????
```
???????:
??? v1.x: 8.5% (???????)
??? v2.0: 1.2% (??????) ?

??????:
??? v1.x: ???? (??????)
??? v2.0: ???? (??????) ?
```

## ?? ??????

### 1. ??????
- **??????**??????????PDF????
- **???????**???????????
- **?????**???????????????

### 2. ?????
- **??????**?????????????
- **??????**???????CPU??
- **??????**?????????????

### 3. ?????
- **??????**???????????
- **??????**?????????????
- **??????**?????????????

## ?? ??????

### v2.1 ????
- **?????**?OneDrive?Google Drive??????
- **OCR????**???????????
- **????**????????????

### v2.2 ????
- **?????**?????App??????
- **????**????????????
- **????**???????????????

---

**?? ????**: ?????TrayPrinterApp v2.0??PDF???????????????????????????????????????????????????GitHub Issue?????